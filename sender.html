<!doctype html>
<html lang="ko">
<head>
  <meta charset="UTF-8">
  <title>ğŸ“¤ Sender</title>
</head>
<body>
  <h1>ğŸ“¤ Sender</h1>
  <input type="file" id="fileInput" accept="image/*">
  <button id="sendBtn">ì‚¬ì§„ ì „ì†¡</button>
  <p>ì—°ê²° ìƒíƒœ: <span id="status">ì—°ê²° ì•ˆë¨</span></p>

  <script>
    const WS_URL = "wss://spring-salad-09fe.slvjek.workers.dev";
    const ws = new WebSocket(WS_URL);

    ws.onopen = () => { document.getElementById('status').innerText = "âœ… ì—°ê²°ë¨"; };
    ws.onclose = () => { document.getElementById('status').innerText = "âŒ ëŠê¹€"; };

    document.getElementById('sendBtn').onclick = async () => {
      const file = document.getElementById('fileInput').files[0];
      if (!file) return alert("ì‚¬ì§„ì„ ì„ íƒí•˜ì„¸ìš”!");

      // íŒŒì¼ ì •ë³´ ë¨¼ì € ì „ì†¡
      ws.send(JSON.stringify({ type: "meta", name: file.name, mime: file.type }));

      // ì‹¤ì œ íŒŒì¼ ë‚´ìš© ì „ì†¡
      const arrayBuffer = await file.arrayBuffer();
      ws.send(arrayBuffer);

      alert("ì‚¬ì§„ ì „ì†¡ ì™„ë£Œ!");
    };
  </script>
</body>
</html>
